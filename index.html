<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>demo // flow</title>
  <style>
    :root { color-scheme: light dark; }
    body { margin:0; font-family: system-ui, sans-serif; }
    main { max-width: 680px; margin: 0 auto; padding: 28px 18px 64px; }
    h1 { font-size: 18px; letter-spacing: .08em; text-transform: lowercase; margin-bottom: 18px; }
    .card { border: 1px solid rgba(127,127,127,.35); border-radius: 14px; padding: 18px; margin: 14px 0; }
    .muted { opacity: .7; }
    .row { display:flex; gap:10px; flex-wrap: wrap; margin-top: 10px; }
    input { flex: 1; padding: 10px; border-radius: 10px; border: 1px solid rgba(127,127,127,.45); background: transparent; }
    button { padding: 10px 12px; border-radius: 10px; border: 1px solid rgba(127,127,127,.45); background: transparent; cursor: pointer; }
    .hidden { display:none; }
    .footer { font-size: 12px; opacity:.7; margin-top: 8px; }
    a { color: inherit; }
  </style>
</head>
<body>
<main>
  <h1>demo // scavenger flow</h1>

  <div class="footer">
    demonstration only · placeholder text · mechanics preview
  </div>

  <!-- STAGE 0 -->
  <section class="card stage" id="s0">
    <div class="muted">stage 0</div>
    <h2>entry</h2>
    <p>
      this is a placeholder introduction.<br>
      imagine atmosphere here.
    </p>
    <p class="muted">
      a fictional riddle would normally appear.
    </p>

    <div class="row">
      <input id="a0" placeholder="enter demo answer" />
      <button onclick="check(0)">continue</button>
    </div>
    <div class="footer" id="m0"></div>
  </section>

  <!-- STAGE 1 -->
  <section class="card stage hidden" id="s1">
    <div class="muted">stage 1</div>
    <h2>second step</h2>
    <p>
      this represents an external lookup.<br>
      nothing meaningful is hidden.
    </p>

    <div class="row">
      <input id="a1" placeholder="enter demo answer" />
      <button onclick="check(1)">continue</button>
    </div>
    <div class="footer" id="m1"></div>
  </section>

  <!-- STAGE 2 -->
  <section class="card stage hidden" id="s2">
    <div class="muted">stage 2</div>
    <h2>third step</h2>
    <p>
      imagine a different website or object here.<br>
      this text is filler.
    </p>

    <div class="row">
      <input id="a2" placeholder="enter demo answer" />
      <button onclick="check(2)">continue</button>
    </div>
    <div class="footer" id="m2"></div>
  </section>

  <!-- STAGE 3 -->
  <section class="card stage hidden" id="s3">
    <div class="muted">stage 3</div>
    <h2>final gate</h2>
    <p>
      this would normally confirm completion.<br>
      demo text only.
    </p>

    <div class="row">
      <input id="a3" placeholder="enter demo answer" />
      <button onclick="check(3)">finish</button>
    </div>
    <div class="footer" id="m3"></div>
  </section>

  <!-- FINAL -->
  <section class="card stage hidden" id="final">
    <div class="muted">end</div>
    <h2>complete</h2>
    <p>
      this is where a reveal would normally happen.<br>
      nothing is revealed in the demo.
    </p>
  </section>
</main>

<script>
  const stages = [
    { next:"s1", answers:["a"] },
    { next:"s2", answers:["b"] },
    { next:"s3", answers:["c"] },
    { next:"final", answers:["d"] }
  ];

  const stageIds = ["s0","s1","s2","s3","final"];
  const KEY = "demo_unlocked";

  function getUnlocked(){ return Number(localStorage.getItem(KEY) || "0"); }
  function setUnlocked(n){ localStorage.setItem(KEY, String(n)); }
  if (localStorage.getItem(KEY) === null) setUnlocked(0);

  function norm(s){ return (s||"").trim().toLowerCase(); }

  function showStage(id){
    document.querySelectorAll(".stage").forEach(e=>e.classList.add("hidden"));
    document.getElementById(id).classList.remove("hidden");
    location.hash = id === "s0" ? "" : "#" + id;
  }

  function check(i){
    const v = norm(document.getElementById("a"+i).value);
    const m = document.getElementById("m"+i);
    if (stages[i].answers.includes(v)){
      const next = Math.min(i+1, stageIds.length-1);
      setUnlocked(Math.max(getUnlocked(), next));
      showStage(stageIds[next]);
    } else {
      m.textContent = "demo input rejected";
    }
  }

  function route(){
    const h = (location.hash||"").replace("#","");
    const idx = h ? stageIds.indexOf(h) : 0;
    const safe = idx !== -1 && idx <= getUnlocked() ? idx : getUnlocked();
    showStage(stageIds[safe]);
  }

  window.addEventListener("hashchange", route);
  route();
</script>
</body>
</html>
